<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sham Salong</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Loading bar at top */
    #loadingBar {
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: linear-gradient(to right, #4B0082, #FFD700);
      width: 0%;
      z-index: 9999;
      transition: width 0.4s ease;
    }

    /* Shine effect on booking forms */
    .shine {
      position: relative;
      overflow: hidden;
    }
    .shine::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      height: 100%;
      width: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.4), transparent);
      transform: skewX(-25deg);
    }
    .shine:hover::before {
      animation: shineMove 1.2s ease forwards;
    }
    @keyframes shineMove {
      100% { left: 200%; }
    }
  </style>
</head>
<body class="bg-gradient-to-r from-purple-900 via-purple-800 to-yellow-400 text-white min-h-screen flex flex-col">

  <!-- Loading bar -->
  <div id="loadingBar"></div>

  <!-- Header -->
  <header class="bg-black bg-opacity-70 flex flex-col md:flex-row justify-between items-center p-4">
    <h1 class="text-2xl font-bold mb-2 md:mb-0">Sham Salong</h1>
    <div class="flex flex-row items-center gap-2">
      <span id="userName" class="font-semibold"></span>
      <button id="loginBtn" class="bg-yellow-400 text-black px-4 py-2 rounded font-bold" onclick="openModal('login')">Logga in</button>
      <button id="registerBtn" class="bg-yellow-400 text-black px-4 py-2 rounded font-bold" onclick="openModal('register')">Registrera</button>
      <button id="logoutBtn" class="bg-red-600 text-white px-4 py-2 rounded font-bold hidden" onclick="logout()">Logga ut</button>
    </div>
  </header>

  <!-- About Section -->
  <section class="bg-purple-900 bg-opacity-80 rounded-xl p-8 mx-auto my-6 max-w-3xl text-center">
    <h2 class="text-3xl mb-4">Om oss</h2>
    <p>Sham Salong erbjuder kvalitativa klippningar, sk√§ggv√•rd och f√§rgning i hj√§rtat av staden ‚Äì din lokala premium barbershop.</p>
  </section>

  <!-- Guest Booking Form -->
  <section id="guestBookingSection" class="shine bg-black bg-opacity-70 rounded-xl p-8 mx-auto my-6 max-w-3xl text-center">
    <h2 class="text-2xl mb-4">Boka som g√§st</h2>
    <form id="guestBookingForm" class="flex flex-col gap-4">
      <input type="text" id="guestName" placeholder="Ditt namn" class="p-2 rounded text-black" required>
      <input type="text" id="guestPhone" placeholder="Telefonnummer" class="p-2 rounded text-black" required>
      <select id="guestService" class="p-2 rounded text-black" required>
        <option value="">V√§lj tj√§nst</option>
        <option value="fade">Fade - 250 kr</option>
        <option value="sk√§gg">Sk√§gg - 150 kr</option>
        <option value="f√§rgning">F√§rgning - 600 kr</option>
        <option value="barn">Barnklippning - 200 kr</option>
      </select>
      <input type="datetime-local" id="guestTime" class="p-2 rounded text-black" required>
      <button type="submit" class="bg-yellow-400 text-black font-bold py-2 rounded">Boka som g√§st</button>
    </form>
  </section>

  <!-- Logged-in Booking Section -->
  <section id="userBookingSection" class="shine hidden bg-black bg-opacity-70 rounded-xl p-8 mx-auto my-6 max-w-3xl text-center">
    <h2 class="text-2xl mb-4">Min bokning</h2>
    <div id="userBookings" class="flex flex-col gap-4"></div>
    <p class="mt-4 text-yellow-400">Klicka p√• en bokning f√∂r att redigera tid eller tj√§nst.</p>
  </section>

  <!-- Inline Calendly -->
  <section class="shine bg-black bg-opacity-70 rounded-xl p-8 mx-auto my-6 max-w-3xl text-center">
    <h2 class="text-2xl mb-4">Boka via Calendly</h2>
    <div class="calendly-inline-widget" data-url="https://calendly.com/mohammadyamenmustafa37?background_color=4b0082&text_color=ffffff&primary_color=ffd700" style="min-width:320px;height:700px;"></div>
  </section>

  <!-- Contact -->
  <section class="bg-purple-900 bg-opacity-80 rounded-xl p-8 mx-auto my-6 max-w-3xl text-center">
    <h2 class="text-2xl mb-4">Kontakta oss</h2>
    <p>üìû 0793488688</p>
    <p>üìß shams.barbershop74@gmail.com</p>
    <p>üìç Esplanaden 1B</p>
  </section>

  <!-- Auth Modal -->
  <div id="authModal" class="fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center hidden z-50">
    <div class="bg-white text-black p-6 rounded-lg w-11/12 max-w-md relative">
      <button class="absolute top-2 right-2 bg-red-600 text-white rounded-full w-8 h-8" onclick="closeModal()">√ó</button>
      <h3 id="modalTitle" class="text-2xl font-bold mb-4">Logga in</h3>
      <input type="email" id="email" placeholder="Email" class="w-full p-2 rounded mb-2">
      <input type="password" id="password" placeholder="L√∂senord" class="w-full p-2 rounded mb-2">
      <button id="authSubmit" class="w-full bg-yellow-400 text-black py-2 rounded font-bold">Skicka</button>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-80 text-white px-4 py-2 rounded hidden"></div>

  <!-- Firebase & Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCc2a7sx7nq-mH2R6IkWend_HUb06wgZ2A",
      authDomain: "shamsalong-6c54c.firebaseapp.com",
      projectId: "shamsalong-6c54c",
      storageBucket: "shamsalong-6c54c.appspot.com",
      messagingSenderId: "1023072544720",
      appId: "1:1023072544720:web:968e31cc9350bc95803bd5"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    let currentMode = "login";

    const guestSection = document.getElementById("guestBookingSection");
    const userSection = document.getElementById("userBookingSection");
    const userBookings = document.getElementById("userBookings");

    const toast = document.getElementById("toast");
    function showToast(msg, color="black"){
      toast.textContent = msg;
      toast.style.backgroundColor = color;
      toast.classList.remove("hidden");
      setTimeout(()=>toast.classList.add("hidden"),3000);
    }

    // Modal
    window.openModal = (mode)=>{
      currentMode = mode;
      document.getElementById("modalTitle").textContent = mode === "login" ? "Logga in" : "Registrera";
      document.getElementById("authModal").classList.remove("hidden");
    }
    window.closeModal = ()=>document.getElementById("authModal").classList.add("hidden");

    // Auth submit
    document.getElementById("authSubmit").addEventListener("click", async ()=>{
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      try{
        let userCredential;
        if(currentMode==="login") userCredential = await signInWithEmailAndPassword(auth,email,pass);
        else userCredential = await createUserWithEmailAndPassword(auth,email,pass);
        showToast(currentMode==="login"?"Inloggad!":"Registrerad!","green");
        closeModal();
      }catch(err){
        showToast(err.message,"red");
      }
    });

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", ()=>{
      signOut(auth).then(()=>{
        guestSection.classList.remove("hidden");
        userSection.classList.add("hidden");
        document.getElementById("userName").textContent = "";
        document.getElementById("loginBtn").classList.remove("hidden");
        document.getElementById("registerBtn").classList.remove("hidden");
        document.getElementById("logoutBtn").classList.add("hidden");
        showToast("Utloggad!","green");
      });
    });

    // Guest booking form
    document.getElementById("guestBookingForm").addEventListener("submit", e=>{
      e.preventDefault();
      showToast("Bokning skapad f√∂r g√§st!","green");
      e.target.reset();
    });

    // Handle auth state
    onAuthStateChanged(auth, user=>{
      if(user){
        document.getElementById("userName").textContent = `V√§lkommen, ${user.email}`;
        guestSection.classList.add("hidden");
        userSection.classList.remove("hidden");
        document.getElementById("loginBtn").classList.add("hidden");
        document.getElementById("registerBtn").classList.add("hidden");
        document.getElementById("logoutBtn").classList.remove("hidden");

        // Example: Populate user bookings (mock, replace with real backend if needed)
        userBookings.innerHTML = '';
        const exampleBooking = document.createElement("div");
        exampleBooking.className = "bg-yellow-400 text-black p-2 rounded cursor-pointer";
        exampleBooking.textContent = "Fade - 2025-08-20 14:00";
        userBookings.appendChild(exampleBooking);

        // Editable booking click
        exampleBooking.addEventListener("click", ()=>{
          const newService = prompt("Ange ny tj√§nst:", "Fade");
          const newTime = prompt("Ange ny tid:", "2025-08-20 14:00");
          if(newService && newTime) exampleBooking.textContent = `${newService} - ${newTime}`;
        });

      } else {
        guestSection.classList.remove("hidden");
        userSection.classList.add("hidden");
        document.getElementById("loginBtn").classList.remove("hidden");
        document.getElementById("registerBtn").classList.remove("hidden");
        document.getElementById("logoutBtn").classList.add("hidden");
        document.getElementById("userName").textContent = "";
      }
    });
  </script>

  <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
</body>
</html>